'',
'      $("#show-totals").click(function(){',
'        displayMode="totals";',
'        setRootMode(displayMode);',
'        if (filterMode==="player") {',
'          if (currentPlayerCat) {',
'            (POS_TABLES[currentPlayerCat]||[]).forEach(k=>{',
'              const m=TABLES[k];',
'              if(m.dt){ m.dt.order([[2,"asc"]]).draw(); updateTotalsKey(k); }',
'            });',
'          }',
'        } else {',
'          Object.values(TABLES).forEach(m=>{',
'            if(m.dt){ m.dt.order(defaultOrderFor(m, filterMode)).draw(); }',
'          });',
'        }',
'        if (filterMode==="position" && currentPosCat) { applyPositionLimit(currentPosCat); }',
'        persistState();',
'      });',
'      $("#show-pcts").click(function(){',
'        displayMode="pcts";',
'        setRootMode(displayMode);',
'        if (filterMode==="player") {',
'          if (currentPlayerCat) {',
'            (POS_TABLES[currentPlayerCat]||[]).forEach(k=>{',
'              const m=TABLES[k];',
'              if(m.dt){ m.dt.order([[2,"asc"]]).draw(); updateTotalsKey(k); }',
'            });',
'          }',
'        } else {',
'          Object.values(TABLES).forEach(m=>{',
'            if(m.dt){ m.dt.order(defaultOrderFor(m, filterMode)).draw(); }',
'          });',
'        }',
'        if (filterMode==="position" && currentPosCat) { applyPositionLimit(currentPosCat); }',
'        persistState();',
'      });',
'      $("#show-both").click(function(){',
'        displayMode="both";',
'        setRootMode(displayMode);',
'        if (filterMode==="player" && currentPlayerCat) {',
'          (POS_TABLES[currentPlayerCat]||[]).forEach(k=>{',
'            const m=TABLES[k];',
'            if(m.dt){ m.dt.order([[2,"asc"]]).draw(); updateTotalsKey(k); }',
'          });',
'        } else {',
'          Object.values(TABLES).forEach(m=>{ if(m.dt) m.dt.order([[2,"desc"]]).draw(); });',
'        }',
'        if (filterMode==="position" && currentPosCat) { applyPositionLimit(currentPosCat); }',
'        persistState();',
'      });',
'',
'      $("#pos-top10").click(function(){',
'        posShowTop=true;  $("#pos-top10").addClass("active"); $("#pos-all").removeClass("active");',
'        if(filterMode==="position" && currentPosCat){',
'          (POS_TABLES[currentPosCat]||[]).forEach(k=>{',
'            clearRowCapKey(k);',
'            const dt = TABLES[k].dt; if(!dt) return;',
'            dt.rows().nodes().to$().css("display","");',
'          });',
'          applyPositionLimit(currentPosCat);',
'          setTimeout(()=>applyPositionLimit(currentPosCat), 0);',
'        }',
'      });',
'      $("#pos-all").click(function(){',
'        posShowTop=false; $("#pos-all").addClass("active"); $("#pos-top10").removeClass("active");',
'        if(filterMode==="position" && currentPosCat){',
'          applyPositionLimit(currentPosCat);',
'          (POS_TABLES[currentPosCat]||[]).forEach(k=>{ applyRowCapKey(k, ROW_CAP_DEFAULT); });',
'        }',
'      });',
'',
'      $("#clear-filters").click(function(){',
'        try{ localStorage.removeItem(LS_KEY); }catch(e){}',
'        $("#player-select,#team-select,#position-select").val(""); $(".week-btn").removeClass("active");',
'        $("#min-snaps-input").val(""); minSnaps=0;',
'        $("#show-totals,#show-pcts,#show-both").removeClass("active"); $("#show-pcts").addClass("active");',
'        displayMode="pcts"; setRootMode(displayMode);',
'        posShowTop=true; $("#pos-top10").addClass("active"); $("#pos-all").removeClass("active"); showPositionLimitControls(false);',
'        filterMode=""; currentPlayerCat=null; currentPosCat=null; $(".filter-btns .btn").removeClass("active"); $(".dropdown-container").hide();',
'        hideAllSections();',
'        Object.values(TABLES).forEach(m=>{ destroyKey(m.key); setBodyKey(m.key, m.orig); $(m.id+" tfoot").hide(); });',
'        (window.requestIdleCallback||function(cb){return setTimeout(cb,1200);})(prewarmCachesLite);',
'        setMobileUI("auto");',
'      });',
'',
'      function hideAllSections(){ Object.keys(POS_SECTION).forEach(p=>{ const s=POS_SECTION[p]; if(s) $(s).hide(); }); }',
'      function setLoading(on){ $(".section .loading-overlay").toggle(!!on); }',
'',
'      function applyFilters(){',
'        const pid=$("#player-select").val();',
'        const tm=($("#team-select").val()||"").trim();',
'        const posSel=$("#position-select").val();',
'        const aw=$(".week-btn.active").map(function(){return String($(this).data("week"));}).get();',
'        const awSet = aw.length ? new Set(aw) : null;',
'        setLoading(true);',
'        if (filterMode || pid || tm || posSel || (awSet && awSet.size) || (minSnaps && minSnaps>0)) window.__skipPrewarm = true;',
'        if(filterMode!=="team") restoreTeamOrder();',
'        hideAllSections();',
'',
'        if(filterMode==="player" && pid){',
'          let pos = (playerMap.get(pid)?.pos || "").toLowerCase();',
'          if(!pos || !POS_TABLES[pos]){ pos = POSITION_ORDER.find(p=>POS_TABLES[p] && POS_TABLES[p].some(k=>TABLES[k].byPid.has(pid))) || POSITION_ORDER[0]; }',
'          currentPlayerCat = pos;',
'          (POS_TABLES[pos]||[]).forEach(k=>{',
'            if (TABLES[k].teamOnly) {',
'              const $wrap = $(TABLES[k].id).closest(".table-responsive"); $wrap.hide(); $wrap.prev("h4").hide();',
'              return;',
'            }',
'            destroyKey(k);',
'            const arr = TABLES[k].byPid.get(pid) || [];',
'            let newHtml="";',
'            arr.forEach(function(tr){',
'              const $tds=$(tr).find("td");',
'              const w=$tds.eq(2).text().trim();',
'              if(awSet && !awSet.has(w)) return;',
'              const m=TABLES[k];',
'              const snapIdx=(m.snapTotalIdx!=null? m.snapTotalIdx : m.firstTotalIdx);',
'              const $clone=$(tr).clone();',
'              const $sn=$clone.children().eq(snapIdx).addClass("snaps-col");',
'              const sv=parseFloat($sn.attr("data-num")||"");',
'              if(Number.isFinite(sv)) $clone.attr("data-snaps", String(sv));',
'              newHtml += $clone.prop("outerHTML");',
'            });',
'            setBodyKey(k, newHtml); ensureNonEmptyKey(k); ensureInitKey(k, "player");',
'            TABLES[k].dt.column(0).visible(false); $(TABLES[k].id+" tfoot").show();',
'            const $wrap = $(TABLES[k].id).closest(".table-responsive"); $wrap.show(); $wrap.prev("h4").show();',
'            clearRowCapKey(k);',
'          });',
'          $(POS_SECTION[pos]).show();',
'',
'        } else if(filterMode==="team" && tm){',
'          currentPlayerCat = null;',
'          const wkey = aw.length ? aw.slice().sort((a,b)=>+a-+b).join(",") : "*";',
'          TEAM_DISPLAY_ORDER.filter(p=>POS_TABLES[p]).forEach(pos=>{',
'            (POS_TABLES[pos]||[]).forEach(k=>{',
'              if (TABLES[k] && TABLES[k].hideInTeam) {',
'                const $wrap = $(TABLES[k].id).closest(".table-responsive");',
'                $wrap.hide(); $wrap.prev("h4").hide();',
'                return;',
'              }',
'              const $wrap = $(TABLES[k].id).closest(".table-responsive");',
'              $wrap.show(); $wrap.prev("h4").show();',
'              destroyKey(k);',
'              const ck = `${k}|${tm}|${wkey}`;',
'              let html = cacheTeam.get(ck);',
'              if(html===undefined){ html = htmlForTeam(k, tm, awSet); cacheTeam.set(ck, html); }',
'              setBodyKey(k, html); ensureNonEmptyKey(k); ensureInitKey(k, "team");',
'              TABLES[k].dt.column(1).visible(false); TABLES[k].dt.column(2).visible(false);',
'              $(TABLES[k].id+" tfoot").hide();',
'              clearRowCapKey(k);',
'            });',
'            $(POS_SECTION[pos]).show();',
'          });',
'          const $sections=$("#sections"); TEAM_DISPLAY_ORDER.filter(p=>POS_SECTION[p]).forEach(p=>$(POS_SECTION[p]).appendTo($sections));',
'          reorderTeamLinear();',
'',
'        } else if(filterMode==="position" && posSel){',
'          const pos=(posSel||"").toLowerCase(); if(!POS_TABLES[pos]){ showPositionLimitControls(false); return; }',
'          currentPosCat=pos;',
'          (POS_TABLES[pos]||[]).forEach(k=>{',
'            if (TABLES[k].teamOnly) {',
'              const $wrap = $(TABLES[k].id).closest(".table-responsive"); $wrap.hide(); $wrap.prev("h4").hide();',
'              return;',
'            }',
'            destroyKey(k);',
'            const wkey = aw.length ? aw.slice().sort((a,b)=>+a-+b).join(",") : "*";',
'            const ck=`${k}|${wkey}`;',
'            let html = cachePos.get(ck);',
'            if(html===undefined){ html = htmlForPosition(k, awSet); cachePos.set(ck, html); }',
'            setBodyKey(k, html); ensureNonEmptyKey(k); ensureInitKey(k, "position");',
'            TABLES[k].dt.column(2).visible(false); $(TABLES[k].id+" tfoot").hide();',
'            const $wrap = $(TABLES[k].id).closest(".table-responsive"); $wrap.show(); $wrap.prev("h4").show();',
'            maybeApplyRowCap(TABLES[k]);',
'          });',
'          $(POS_SECTION[pos]).show(); showPositionLimitControls(true); applyPositionLimit(pos);',
'        } else {',
'          currentPlayerCat=null; showPositionLimitControls(false);',
'        }',
'        setLoading(false);',
'        applyMobileRoot();',
'        // Ensure Top 10 is enforced after the post-init draw/adjust',
'        if (filterMode==="position" && currentPosCat && posShowTop) {',
'          setTimeout(function(){ applyPositionLimit(currentPosCat); }, 0);',
'        }',
'        // Re-apply snap threshold if active (after tables were rebuilt)',
'        if (minSnaps && minSnaps > 0) {',
'          Object.values(TABLES).forEach(m => { if (m.dt) m.dt.draw(false); });',
'        }',
'      }',
'',
'      function fullReset(){',
'        hideAllSections(); $(".filter-btns .btn").removeClass("active");',
'        $("#qb-totals-row,#wr-totals-row,#te-totals-row,#rb-totals-row,#rb_pre_snap-totals-row,#wr_pre_snap-totals-row,#te_pre_snap-totals-row").parent().hide();',
'      }',
'',
'      displayMode="totals"; setRootMode(displayMode);',
'',
'      (function(){',
'        try{',
'          const raw = localStorage.getItem(LS_KEY);',
'          if(!raw) return;',
'          const o = JSON.parse(raw) || {};',
'',
'          if (o.display) {',
'            displayMode = (o.display==="pcts"?"pcts":(o.display==="both"?"both":"totals"));',
'            setRootMode(displayMode);',
'          }',
'          if (Array.isArray(o.weeksSel) && o.weeksSel.length) {',
'            $(".week-btn").each(function(){',
'              const w = String($(this).data("week"));',
'              $(this).toggleClass("active", o.weeksSel.includes(w));',
'            });',
'          }',
'          if (typeof o.posShowTop === "boolean") {',
'            posShowTop = o.posShowTop;',
'            $("#pos-top10").toggleClass("active",  posShowTop);',
'            $("#pos-all").toggleClass("active",   !posShowTop);',
'          }',
'',
'          // Restore minSnaps and draw once tables exist',
'          if (Number.isFinite(+o.minSnaps) && +o.minSnaps > 0) {',
'            minSnaps = +o.minSnaps;',
'            $("#min-snaps-input").val(String(minSnaps));',
'            setTimeout(function(){ Object.values(TABLES).forEach(m => { if (m.dt) m.dt.draw(false); }); }, 0);',
'          }',
'',
'          if (o.mode === "player" && o.player) {',
'            filterMode = "player";',
'            $("#pick-player").addClass("active");',
'            $("#player-dropdown").show();',
'            $("#player-select").val(o.player);',
'            showPositionLimitControls(false);',
'          } else if (o.mode === "team" && o.team) {',
'            filterMode = "team";',
'            $("#pick-team").addClass("active");',
'            $("#team-dropdown").show();',
'            $("#team-select").val(o.team);',
'            showPositionLimitControls(false);',
'          } else if (o.mode === "position" && o.position) {',
'            filterMode = "position";',
'            $("#pick-position").addClass("active");',
'            $("#position-dropdown").show();',
'            $("#position-select").val(o.position);',
'            showPositionLimitControls(true);',
'          }',
'',
'          if (o.mobileMode==="on" || o.mobileMode==="off" || o.mobileMode==="auto"){',
'            setMobileUI(o.mobileMode);',
'          } else {',
'            applyMobileRoot();',
'          }',
'        } catch(e){}',
'      })();',
'',
'      // ===== Footer fixes (visibility-aware) =====',
'      function _sr_ratioParts(txt){',
'        const m=String(txt||"").match(/^\\s*([0-9]+(?:\\.[0-9]+)?)\\s*\\/\\s*([0-9]+(?:\\.[0-9]+)?)\\s*$/);',
'        return m ? {num:parseFloat(m[1]), den:parseFloat(m[2])} : null;',
'      }',
'      function _sr_toFixedSafe(v,d){',
'        if(!isFinite(v)) return "0";',
'        try { return Number(v).toFixed(d); } catch(e){ return String(v); }',
'      }',
'      function _sr_headerMetaVisible($t){',
'        const meta=[];',
'        $t.find("thead th").each(function(){',
'          const vis = this.offsetParent!==null && window.getComputedStyle(this).display!=="none";',
'          if(!vis) return;',
'          const $th=$(this);',
'          const role = $th.hasClass("pct-col") ? "pct" : ($th.hasClass("total-col") ? "total" : "info");',
'          meta.push({ role:role, ratioDec:$th.hasClass("ratio-dec"), dp:$th.hasClass("ratio-dec-2")?2:($th.hasClass("ratio-dec")?1:1) });',
'        });',
'        return meta;',
'      }',
'      // Reduce tfoot colspans to only cover visible header columns (stable across repeated runs)',
'      function _sr_fixFooterColspans($t){',
'        if(!$t || !$t.length) return;',
'        // Build 1-based list of hidden header indexes',
'        const hiddenIdx=[];',
'        $t.find("thead th").each(function(i){',
'          const hidden = (this.offsetParent===null) || window.getComputedStyle(this).display==="none";',
'          if(hidden) hiddenIdx.push(i+1);',
'        });',
'        if(!hiddenIdx.length) return;',
'        $t.find("tfoot tr").each(function(){',
'          let pos=1;',
'          Array.prototype.slice.call(this.cells).forEach(function(td){',
'            let orig = parseInt(td.getAttribute("data-o-colspan")||"0",10);',
'            if(!orig || orig<1){ orig = (td.colSpan && td.colSpan>1)? td.colSpan : 1; td.setAttribute("data-o-colspan", String(orig)); }',
'            const hits = hiddenIdx.filter(function(i){ return i>=pos && i<pos+orig; }).length;',
'            const newSpan = Math.max(0, orig - hits);',
'            if(newSpan===0){ td.style.display="none"; }',
'            else { td.style.display=""; td.colSpan=newSpan; }',
'            pos += orig; // advance by original coverage, not the shrunken span',
'          });',
'        });',
'      }',
'      // Strip denominators / compute % or ratios in the now-aligned footer',
'      function _sr_normalizeFooter($t){',
'        if(!$t || !$t.length) return;',
'        const tr=$t.find("tfoot tr")[0]; if(!tr) return;',
'        const meta=_sr_headerMetaVisible($t);',
'        let pos=0;',
'        for(const td of tr.cells){',
'          const span=(td.colSpan && td.colSpan>1)? td.colSpan : 1;',
'          if(span>1){ pos+=span; continue; }',
'          const parts=_sr_ratioParts(td.textContent);',
'          const col=meta[pos] || {role:"info"};',
'          if(parts){',
'            if(col.role==="total"){',
'              td.textContent=_sr_toFixedSafe(parts.num,0);',
'            } else if(col.role==="pct"){',
'              if(col.ratioDec){',
'                td.textContent=_sr_toFixedSafe(parts.num/(parts.den||1), col.dp);',
'              } else {',
'                td.textContent=_sr_toFixedSafe((parts.num/(parts.den||1))*100, 1) + "%";',
'              }',
'            }',
'          }',
'          pos+=1;',
'        }',
'      }',
'',
'      // Initial pass on page load for all tables',
'      $("#snap-rates table").each(function(){',
'        const $t=$(this);',
'        _sr_fixFooterColspans($t);',
'        _sr_normalizeFooter($t);',
'      });',
'',
'      // After every DataTables draw (paging/sorting/filtering)',
'      $(document).on("draw.dt", function(e, settings){',
'        const $tbl = $(settings.nTable);',
'        _sr_fixFooterColspans($tbl);',
'        _sr_normalizeFooter($tbl);',
'        // keep your fantasy rounding fix',
'        try{ roundFantasyPointsIn($tbl); }catch(e){}',
'      });',
'      // ===== Min Snaps filter (global DataTables hook + UI handlers) =====',
'      // Robustly read the Snaps value from the row (prefer <td class="snaps-col">)',
'      function getSnapsFromRow(meta, settings, dataIndex){',
'        const rowObj = settings.aoData[dataIndex];',
'        const tr = rowObj && rowObj.nTr;',
'        if (!tr) return NaN;',
'        // Fast path: row-level cache',
'        const ds = tr.getAttribute("data-snaps");',
'        if (ds!=null && ds!=="") {',
'          const v = parseFloat(ds);',
'          if (Number.isFinite(v)) return v;',
'        }',
'        // Fallbacks (rare)',
'        let td = tr.querySelector("td.snaps-col");',
'        if (!td) {',
'          const idx = (meta.snapTotalIdx != null) ? meta.snapTotalIdx : ((meta.firstTotalIdx != null) ? meta.firstTotalIdx : 3);',
'          td = (tr.cells && tr.cells[idx]) ? tr.cells[idx] : null;',
'        }',
'        if (!td) return NaN;',
'        const numAttr = td.getAttribute("data-num");',
'        let val = (numAttr != null && numAttr !== "" && !isNaN(numAttr)) ? parseFloat(numAttr) : NaN;',
'        if (!Number.isFinite(val)) {',
'          const txt = (td.textContent || "").replace(/,/g, "").trim();',
'          const left = txt.split("/")[0];',
'          const m = left.match(/-?\\d+(?:\\.\\d+)?/);',
'          val = m ? parseFloat(m[0]) : NaN;',
'        }',
'        // backfill cache',
'        if (Number.isFinite(val)) tr.setAttribute("data-snaps", String(val));',
'        return val;',
'      }',
'',
'      const snapThresholdFilter = function (settings, data, dataIndex) {',
'        if (!minSnaps || minSnaps <= 0) return true;',
'        const tableId = settings.nTable ? (settings.nTable.id || "") : "";',
'        const key = tableId.replace(/_table$/, "");',
'        const meta = TABLES[key];',
'        if (!meta) return true;',
'        const snaps = getSnapsFromRow(meta, settings, dataIndex);',
'        if (!Number.isFinite(snaps)) return true;', # don\'t exclude if unreadable',
'        return snaps >= minSnaps;',
'      };',
'      $.fn.dataTable.ext.search.push(snapThresholdFilter);',
'',
'      function applyMinSnapsNow(){',
'        const raw = String($("#min-snaps-input").val() || "").trim();',
'        const parsed = parseInt(raw, 10);',
'        if (Number.isFinite(parsed) && parsed >= 0) {',
'          minSnaps = parsed;',
'        } else {',
'          minSnaps = 0;',
'          $("#min-snaps-input").val("");',
'        }',
'        persistState();',
'        // Redraw all tables so the global filter runs',
'        Object.values(TABLES).forEach(m => { if (m.dt) m.dt.draw(false); });',
'        // If we are in Position view, re-apply the Top-10/All limiter after the draw',
'        if (filterMode === "position" && currentPosCat) {',
'          setTimeout(function(){',
'            applyPositionLimit(currentPosCat);',
'            (POS_TABLES[currentPosCat] || []).forEach(k => maybeApplyRowCap(TABLES[k]));',
'          }, 0);',
'        }',
'      }',
'      $("#apply-snaps-btn").on("click", applyMinSnapsNow);',
'      $("#min-snaps-input").on("keydown", function(e){ if (e.key === "Enter") { e.preventDefault(); applyMinSnapsNow(); } });',
'      $("#clear-snaps-btn").on("click", function(){ $("#min-snaps-input").val(""); minSnaps = 0; persistState(); Object.values(TABLES).forEach(m => { if (m.dt) m.dt.draw(false); }); });',
'',
'      applyFilters();',
'      // Donâ€™t compete with first filter interactions; defer cache warmup',
'      (function(){',
'        var prewarmed=false, timer=null;',
'        function run(){ if(prewarmed) return; prewarmed=true; try{ prewarmCachesLite(); }catch(e){} }',
'        function schedule(ms){ if(timer){ clearTimeout(timer); } timer=setTimeout(run, ms); }',
'        // Any interaction with filter UI postpones warmup by 4s',
'        var sel = "#snap-rates .filter-btns, #player-dropdown, #team-dropdown, #position-dropdown, #snap-rates .week-filter, #snap-rates .snap-filter, #snap-rates .toggle-btns, #snap-rates .mobile-toggle";',
'        document.querySelectorAll(sel).forEach(function(n){',
'          n.addEventListener("pointerdown", function(){ if(!prewarmed) schedule(4000); }, {passive:true});',
'          n.addEventListener("keydown", function(){ if(!prewarmed) schedule(4000); });',
'        });',
'        // First chance to warm up: a bit after full load/paint',
'        window.addEventListener("load", function(){ schedule(3500); });',
'      })();',
'',
'    });',
'  </script>',
'</div>',
'  <script>',
'    $(function(){',
'      // Round any header with .ratio-dec (1 dp) or .ratio-dec-2 (2 dp) in BODY and FOOTER.',
'      function formatMarkedColumns($t){',
'        if(!$t || !$t.length) return;',
'        const idxToDp = new Map();',
'        $t.find("thead th").each(function(i){',
'          if (this.classList.contains("ratio-dec") || this.classList.contains("ratio-dec-2")){',
'            idxToDp.set(i, this.classList.contains("ratio-dec-2") ? 2 : 1);',
'          }',
'        });',
'        if(!idxToDp.size) return;',
'        const fmtRow = function($row){',
'          const $cells = $row.children();',
'          idxToDp.forEach(function(dp, i){',
'            const $c = $cells.eq(i);',
'            let txt = ($c.text()||"").trim();',
'            const hadPct = /%$/.test(txt);',
'            if(hadPct) txt = txt.replace(/%$/,"");',
'            const n = parseFloat(txt);',
'            if(!isNaN(n)){',
'              $c.text(n.toFixed(dp) + (hadPct ? "%" : ""));',
'              $c.attr("data-order", String(n));',
'            }',
'          });',
'        };',
'        $t.find("tbody tr").each(function(){ fmtRow($(this)); });',
'        $t.find("tfoot tr").each(function(){ fmtRow($(this)); });',
'      }',
'',
'      // Specifically: any column whose header text contains "Fantasy Points" -> 1 dp.',
'      function roundFantasyPointsIn($t){',
'        if(!$t || !$t.length) return;',
'        const fpIdx = [];',
'        $t.find("thead th").each(function(i){',
'          const label = (this.getAttribute("data-label") || this.textContent || "").trim().toLowerCase();',
'          if (label.includes("fantasy points")) fpIdx.push(i);',
'        });',
'        if(!fpIdx.length) return;',
'        const roundRow = function($row){',
'          const $cells = $row.children();',
'          fpIdx.forEach(function(i){',
'            const $c = $cells.eq(i);',
'            const n = parseFloat(($c.text()||"").trim());',
'            if(!isNaN(n)){',
'              $c.text(n.toFixed(1));',
'              $c.attr("data-order", String(n));',
'            }',
'          });',
'        };',
'        $t.find("tbody tr").each(function(){ roundRow($(this)); });',
'        $t.find("tfoot tr").each(function(){ roundRow($(this)); });',
'      }',
'',
'      // Initial pass on page load',
'      $("table").each(function(){',
'        const $t = $(this);',
'        formatMarkedColumns($t);',
'        roundFantasyPointsIn($t);',
'      });',
'',
'      // After every DataTables draw (paging/sorting/filtering)',
'      $(document).on("draw.dt", function(e, settings){',
'        const $tbl = $(settings.nTable);',
'        formatMarkedColumns($tbl);',
'        roundFantasyPointsIn($tbl);',
'      });',
'    });',
'  </script>',
'</body>',
'</html>'
)
file_name <- paste(
"~/html_tests/utilization_report",
league_id,
season,
week,
"body",
".html",
sep = "_"
)
# Write HTML and CSV to disk
writeLines(combined_html, file_name)
gert::git_add(".") # stage everything
gert::git_commit("Update HTML") # commit staged files
gert::git_push(remote = "origin")
